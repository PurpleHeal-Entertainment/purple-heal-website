<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Purple Heal Entertainment - Discogr√°fica independiente con los mejores artistas emergentes">
  <title>Purple Heal Entertainment | Discogr√°fica Musical</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/reset.css?v=1.9">
  <link rel="stylesheet" href="css/variables.css?v=1.9">
  <link rel="stylesheet" href="css/global.css?v=1.9">
  <link rel="stylesheet" href="css/components.css?v=2.4">

  <!-- Favicon -->

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="assets/logos/PURPLE HEAL LOGO PURPURA.svg">
</head>

<body>
  <div class="site-wrapper">
    <!-- Navigation -->
    <nav class="ph-nav" id="navbar">
      <div class="container ph-nav__container">
        <a href="index.html">
          <img src="assets/logos/PURPLE HEAL LOGO TEXTO BLANCO OPCION 2.svg" alt="Purple Heal Logo"
            class="ph-nav__logo">
        </a>

        <div class="ph-nav__menu">
          <a href="index.html" class="ph-nav__link active">Inicio</a>
          <a href="artists.html" class="ph-nav__link">Artistas</a>
          <a href="tours.html" class="ph-nav__link">Tours</a>
          <a href="shop.html" class="ph-nav__link" id="nav-shop" style="display: none;">Tienda</a>
          <a href="about.html" class="ph-nav__link">Nosotros</a>
        </div>

        <div class="ph-nav__toggle" id="nav-toggle">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </nav>

    <!-- Mobile Menu -->
    <div class="ph-mobile-menu">
      <div class="ph-mobile-menu__content">
        <a href="index.html" class="ph-mobile-menu__link active">Inicio</a>
        <a href="artists.html" class="ph-mobile-menu__link">Artistas</a>
        <a href="tours.html" class="ph-mobile-menu__link">Tours</a>
        <a href="shop.html" class="ph-mobile-menu__link" id="nav-shop-mobile" style="display: none;">Tienda</a>
        <a href="about.html" class="ph-mobile-menu__link">Nosotros</a>
      </div>
    </div>

    <!-- Hero Section -->
    <section class="hero fade-in">
      <div class="hero__content">
        <img src="assets/logos/PURPLE HEAL LOGO PURPURA EN PNG.png" alt="Purple Heal Logo" class="hero__logo">
        <h1 class="hero__title">
          CREANDO EL FUTURO<br>
          DE LA MUSICA
        </h1>
        <p class="hero__subtitle">
          Descubre a los artistas m√°s talentosos y √∫nicos de la nueva generaci√≥n musical.
          Purple Heal Entertainment es m√°s que una discogr√°fica, es una familia de creadores.
        </p>
        <div class="hero__actions"
          style="display: flex; gap: var(--space-lg); justify-content: center; margin-top: var(--space-2xl); flex-wrap: wrap;">
          <a href="artists.html" class="ph-button ph-button--primary">Ver Artistas</a>
          <a href="about.html" class="ph-button ph-button--outline">Conoce mas</a>
        </div>
      </div>
    </section>


    <!-- FEATURED TOUR (Dynamic) -->
    <section id="featured-tour-container" style="display: none;"></section>

    <!-- Featured Artists -->
    <section id="featured" style="background: rgba(0, 0, 0, 0.3);">
      <div class="container">
        <h2 class="text-center slide-in-left">
          NUESTROS <span class="text-gradient">ARTISTAS</span>
        </h2>
        <p class="text-center"
          style="color: var(--ph-gray-lighter); max-width: 600px; margin: 0 auto var(--space-3xl);">
          Conoce a los talentosos artistas que forman parte de la familia Purple Heal
        </p>

        <div class="grid" id="artistsGrid"
          style="display: flex; justify-content: center; gap: var(--space-lg); flex-wrap: wrap;">
          <!-- Artists will be loaded dynamically from IndexedDB -->
        </div>

        <div style="text-align: center; margin-top: var(--space-3xl);">
          <a href="artists.html" class="ph-button ph-button--gold">Ver Todos los Artistas</a>
        </div>
      </div>
    </section>

    </section>

    <!-- NEW: PROMO SALE SECTION (Between Artists and About) -->
    <section id="promo-sale-section" style="padding: var(--space-3xl) 0; display: none;">
      <div class="container">
        <!-- 2. Promo / Sale (Full Width Block) -->
        <div id="promo-sale" class="ph-card promo-full-card fade-in" style="display: none;">
          <!-- Left: Text Content -->
          <div class="promo-text-content">
            <p id="promo-subtitle"
              style="color: var(--ph-blue-accent); font-family: 'Oxanium'; letter-spacing: 2px; font-size: var(--fs-md); margin-bottom: var(--space-md); text-transform: uppercase;">
              OFERTA LIMITADA
            </p>
            <h2 id="promo-title-main" class="promo-title-main"
              style="line-height: 0.85; margin-bottom: var(--space-lg); font-family: 'Oxanium'; font-weight: 800; color: white; pointer-events: none;">
              50% <span style="color: var(--ph-blue-accent);">OFF</span>
            </h2>
            <p id="promo-desc"
              style="color: var(--ph-gray-lighter); font-size: 1.1rem; max-width: 450px; margin-bottom: var(--space-2xl); line-height: 1.6;">
              Los √°lbumes de tus artistas favoritos ahora con descuento especial. Aprovecha esta oportunidad.
            </p>
            <a id="btn-promo" href="shop.html" class="ph-button ph-button--outline"
              style="border-color: var(--ph-blue-accent); color: var(--ph-blue-accent); position: relative; z-index: 10;">
              VER OFERTAS
            </a>
          </div>

          <!-- Right: Dynamic Product Collage (Grid controlled by CSS) -->
          <div id="promo-images-container" class="promo-products-container">
            <!-- Images injected via JS -->
            <div
              style="position: absolute; inset: 0; background: radial-gradient(circle at center, rgba(214, 0, 28, 0.1) 0%, transparent 70%); pointer-events: none; z-index: 0;">
            </div>
          </div>

          <!-- Background Graphic Elements -->
          <div
            style="position: absolute; top: -50px; right: -50px; font-size: 20rem; font-weight: bold; color: rgba(255,255,255,0.02); font-family: 'Oxanium'; z-index: 1;">
            %</div>
        </div>

      </div>
  </div>
  </section>

  <!-- About Section -->
  <section id="about">
    <div class="container">
      <div style="max-width: 800px; margin: 0 auto; text-align: center;">
        <h2 class="slide-in-right">
          SOBRE <span class="text-gradient">PURPLE HEAL</span>
        </h2>
        <p
          style="font-size: var(--fs-lg); line-height: 1.8; color: var(--ph-gray-lighter); margin-bottom: var(--space-xl);">
          Purple Heal Entertainment naci√≥ con la misi√≥n de dar voz a los artistas independientes
          y revolucionarios que est√°n redefiniendo la m√∫sica contempor√°nea.
        </p>
        </p>

        <!-- DYNAMIC STATS SECTION -->
        <div id="home-stats-section" class="grid grid--3"
          style="margin-top: var(--space-3xl); text-align: center; display: none;">
          <div class="ph-card">
            <div class="ph-card__content">
              <h3 id="stat1-num" style="color: #307FE2; font-size: var(--fs-4xl); margin-bottom: var(--space-sm);">10+
              </h3>
              <p id="stat1-label" style="color: var(--ph-gray-lighter);">Artistas Talentosos</p>
            </div>
          </div>

          <div class="ph-card">
            <div class="ph-card__content">
              <h3 id="stat2-num" style="color: #307FE2; font-size: var(--fs-4xl); margin-bottom: var(--space-sm);">50+
              </h3>
              <p id="stat2-label" style="color: var(--ph-gray-lighter);">Lanzamientos Musicales</p>
            </div>
          </div>

          <div class="ph-card">
            <div class="ph-card__content">
              <h3 id="stat3-num" style="color: #307FE2; font-size: var(--fs-4xl); margin-bottom: var(--space-sm);">100K+
              </h3>
              <p id="stat3-label" style="color: var(--ph-gray-lighter);">Fans en el Mundo</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- NEW: PROMO SALE SECTION (Placed after About? No, User said: "por debajo de artistas ... por encima de SOBRE PURPLE HEAL") -->
  <!-- So it should be BEFORE About. Wait.
       Order: Artists (#featured) -> Sale -> About (#about) -> Backstage
  -->


  <!-- NEW: BACKSTAGE SECTION (Below About) -->
  <section id="backstage-section" style="padding: var(--space-3xl) 0; display: none;">
    <div class="container">
      <!-- 1. Purple Backstage (Centered) -->
      <div id="promo-backstage-wrapper" style="max-width: 800px; margin: 0 auto; display: none;">
        <div id="promo-backstage" class="ph-card ph-backstage-card">
          <div class="ph-card__content"
            style="display: flex; flex-direction: column; justify-content: center; height: 100%; text-align: left;">
            <div
              style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--space-md); margin-bottom: var(--space-md);">
              <p style="color: white; font-weight: bold; font-size: 1.1em;">QUE ES PURPLE BACKSTAGE?</p>
              <span
                style="background: rgba(139, 92, 246, 0.2); color: var(--ph-purple); padding: 4px 8px; border-radius: 4px; font-size: 0.8em; text-transform: uppercase;">MEMBRESIA
                DE YOUTUBE</span>
            </div>

            <ul class="ph-backstage-list">
              <li>
                <span>üé•</span>
                <span>Acceso a detras de camaras y entrevistas exclusivas</span>
              </li>
              <li>
                <span>üí¨</span>
                <span>Comentarios destacados y la posibilidad de recibir una respuesta por parte de uno de los artistas
                  de Purple Heal. ¬°Con suerte te tocar√° tu favorito!</span>
              </li>
              <li>
                <span>ü§ù</span>
                <span>Ayuda directa a la produccion y campa√±as publicitarias</span>
              </li>
            </ul>
            <a id="btn-backstage" href="#" target="_blank" class="ph-button ph-button--primary ph-button--glow"
              style="align-self: flex-start;">
              UNIRME AHORA
            </a>
            <p
              style="font-size: 0.75em; color: rgba(255,255,255,0.5); margin-top: 15px; font-style: italic; line-height: 1.4;">
              * Esta iniciativa busca mejorar la gesti√≥n de nuestros artistas, equipos de producci√≥n y campa√±as
              publicitarias. Aunque este m√©todo no cubrir√° todas nuestras necesidades, es un grano de arena que tanto
              nuestro equipo como los artistas agradecen profundamente.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Contact Section -->
  <section id="contact" style="background: rgba(0, 0, 0, 0.3);">
    <div class="container">
      <div style="max-width: 800px; margin: 0 auto; text-align: center;">
        <h2>TRABAJA CON NOSOTROS</h2>
        <p style="font-size: var(--fs-lg); color: var(--ph-gray-lighter); margin-bottom: var(--space-2xl);">
          Estamos buscando nuevas personas para a√±adir a nuestras filas de equipo, y tambien colaboraciones emocionantes
          en todo momento. Contactanos para mas informacion.
        </p>
        <a href="mailto:purplehealent@gmail.com" class="ph-button ph-button--gold">Contactanos</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="ph-footer">
    <div class="container">
      <div class="ph-footer__content">
        <div class="ph-footer__section">
          <h3>Purple Heal Entertainment</h3>
          <p style="color: var(--ph-gray-light); margin-top: var(--space-sm);">
            Creando el futuro de la m√∫sica, un artista a la vez.
          </p>
        </div>

        <div class="ph-footer__section">
          <h3>Enlaces Rapidos</h3>
          <div class="ph-footer__links">
            <a href="index.html" class="ph-footer__link">Home</a>
            <a href="artists.html" class="ph-footer__link">Artistas</a>
            <a href="#about" class="ph-footer__link">Nosotros</a>
            <a href="#contact" class="ph-footer__link">Contacto</a>
          </div>
        </div>

        <div class="ph-footer__section">
          <h3>Siguenos</h3>
          <div class="ph-footer__links">
            <a href="https://www.instagram.com/purpleheal_ent/" class="ph-footer__link" target="_blank">Instagram</a>
            <a href="https://www.x.com/PURPLEHEAL" class="ph-footer__link" target="_blank">Twitter</a>
            <a href="https://www.youtube.com/@purplehealent" class="ph-footer__link" target="_blank">YouTube</a>
          </div>
        </div>
      </div>

      <div class="ph-footer__bottom">
        <p>&copy; 2026 Purple Heal Entertainment. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>
  </div>

  <!-- JavaScript -->
  <script src="js/storage-db.js?v=2.1"></script>
  <script src="js/main.js?v=2.1"></script>
  <script>
    // Configuration for GitHub Raw
    const REPO_OWNER = 'PurpleHeal-Entertainment';
    const REPO_NAME = 'purple-heal-website';
    const BRANCH = 'master';
    const BASE_URL = `https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/${BRANCH}/data`;

    // Helper: Shuffle Array
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    async function loadAllData() {
      try {
        console.log('‚òÅÔ∏è Fetching homepage data from Cloud...');

        const timestamp = Date.now();
        const headers = { 'Cache-Control': 'no-cache' };

        // Parallel Fetch: Config, Artists, Tours
        const [configRes, artistsRes, toursRes] = await Promise.all([
          fetch(`${BASE_URL}/site_config.json?t=${timestamp}`),
          fetch(`${BASE_URL}/artists.json?t=${timestamp}`),
          fetch(`${BASE_URL}/tours.json?t=${timestamp}`)
        ]);

        if (!configRes.ok || !artistsRes.ok || !toursRes.ok) {
          throw new Error('Failed to fetch one or more resources');
        }

        const config = await configRes.json();
        const artists = await artistsRes.json();
        const tours = await toursRes.json();

        // 1. Render Artists
        renderArtists(artists);

        // 2. Render Stats
        renderStats(config);

        // 3. Render Promos & Special Sections
        renderPromos(config, artists); // Pass artists directly for random collage

        // 4. Render Featured Tour
        if (config.featuredTourId) {
          renderFeaturedTour(config.featuredTourId, tours);
        }

      } catch (error) {
        console.error('‚ùå Error loading homepage data:', error);
        const grid = document.getElementById('artistsGrid');
        if (grid) {
          grid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: var(--space-xl); background: rgba(231, 76, 60, 0.1); border: 1px solid #e74c3c; border-radius: 8px;">
                    <p style="color: #e74c3c; font-weight: bold; margin-bottom: 10px;">Error de conexi√≥n con GitHub</p>
                    <p style="color: var(--ph-gray-lighter); font-size: 0.9em;">
                        No se pudieron cargar los datos. Por favor, aseg√∫rate de haber guardado los cambios en el Panel de Administraci√≥n para sincronizar con la nube.
                        <br><br>
                        <small>Detalle: ${error.message}</small>
                    </p>
                </div>
            `;
        }
      }
    }

    function renderArtists(artists) {
      const grid = document.getElementById('artistsGrid');
      if (!grid) return;

      if (artists && artists.length > 0) {
        // Show only first 3 artists on homepage (or specific ones if configured)
        const displayArtists = artists.slice(0, 3);

        grid.innerHTML = displayArtists.map((artist, index) => `
                <a href="artist-profile.html?artist=${index}" class="artist-card">
                    <img src="${artist.image || 'assets/images/placeholder.png'}" alt="${artist.name}"
                        class="artist-card__image">
                    <div class="artist-card__overlay">
                        <p class="artist-card__genre">${artist.genre || 'Artista'}</p>
                        <h3 class="artist-card__name">${artist.name}</h3>
                        <p class="artist-card__bio">
                            ${artist.bio ? (artist.bio.substring(0, 120) + (artist.bio.length > 120 ? '...' : '')) : 'Descubre m√°s'}
                        </p>
                    </div>
                </a>
            `).join('');
      } else {
        grid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: var(--space-xl);">
                    <p style="color: var(--ph-gray-lighter);">No hay artistas disponibles en este momento.</p>
                </div>
            `;
      }
    }

    function renderStats(config) {
      const statsSection = document.getElementById('home-stats-section');
      if (config.showStats) {
        statsSection.style.display = 'grid';

        if (config.stats && config.stats.length === 3) {
          config.stats.forEach((s, i) => {
            const numId = `stat${i + 1}-num`;
            const labelId = `stat${i + 1}-label`;
            const el = document.getElementById(numId)?.parentElement?.parentElement;
            if (el) {
              if (s.number && s.number.trim() !== '') {
                document.getElementById(numId).textContent = s.number;
                document.getElementById(labelId).textContent = s.label;
                el.style.display = 'block';
              } else {
                el.style.display = 'none';
              }
            }
          });
        }
      } else {
        statsSection.style.display = 'none';
      }
    }

    function renderFeaturedTour(tourId, tours) {
      // tourId can be string or number, check carefully
      const tour = tours.find(t => t.id == tourId);
      const container = document.getElementById('featured-tour-container');

      if (tour && container) {
        container.style.display = 'block';
        container.innerHTML = `
                <div class="ph-featured-tour">
                    <div class="ph-featured-tour__bg" style="background-image: url('${tour.coverImage}');"></div>
                    <div class="ph-featured-tour__overlay"></div>
                    <div class="container ph-featured-tour__content">
                        <div class="fade-in">
                            <span class="ph-featured-tour__tag">TOUR DESTACADO</span>
                            <h2 class="ph-featured-tour__title">${tour.title}</h2>
                            <a href="tours.html" class="ph-button ph-button--primary ph-button--glow">VER DETALLES Y FECHAS</a>
                        </div>
                    </div>
                </div>
            `;
      }
    }

    function renderPromos(config, artists) {
      // Sections
      const backstageSection = document.getElementById('backstage-section');
      const backstageWrapper = document.getElementById('promo-backstage-wrapper');
      const saleSection = document.getElementById('promo-sale-section');
      const saleCard = document.getElementById('promo-sale');

      // Backstage
      if (config.showBackstage && backstageWrapper) {
        backstageSection.style.display = 'block';
        backstageWrapper.style.display = 'block';
        const btn = document.getElementById('btn-backstage');
        if (btn) btn.href = config.backstageLink || '#';
      }

      // Contact
      const contactSection = document.getElementById('contact');
      if (contactSection) {
        const showContact = config.showContact !== false;
        contactSection.style.display = showContact ? 'block' : 'none';
      }

      // Sale Promo
      if (config.showPromo && saleCard) {
        saleSection.style.display = 'block';
        saleCard.style.display = 'flex';

        const btn = document.getElementById('btn-promo');
        if (btn) btn.href = config.promoLink || 'shop.html';

        const titleEl = document.getElementById('promo-title-main');
        const subtitleEl = document.getElementById('promo-subtitle');
        const descEl = document.getElementById('promo-desc');

        const discAlbum = config.promoDiscountAlbum ? parseInt(config.promoDiscountAlbum) : 0;
        const discMerch = config.promoDiscountMerch ? parseInt(config.promoDiscountMerch) : 0;
        const maxDisc = Math.max(discAlbum, discMerch);

        if (titleEl && maxDisc > 0) {
          titleEl.innerHTML = `${maxDisc}% <span style="color: var(--ph-blue-accent);">OFF</span>`;
        } else if (titleEl && config.promoTitle) {
          titleEl.textContent = config.promoTitle;
        }

        if (subtitleEl) {
          if (config.promoSubtitle) {
            subtitleEl.textContent = config.promoSubtitle;
          } else {
            if (discAlbum > 0 && discMerch > 0 && discAlbum === discMerch) {
              subtitleEl.textContent = 'DESCUENTO EN TODOS LOS PRODUCTOS';
            } else if (discAlbum > 0) {
              subtitleEl.textContent = 'OFERTA EN ALBUMES';
            } else if (discMerch > 0) {
              subtitleEl.textContent = 'DESCUENTO EN MERCH';
            } else {
              subtitleEl.textContent = 'GRANDES OFERTAS';
            }
          }
        }

        if (descEl && config.promoDescription) {
          descEl.textContent = config.promoDescription;
        }

        // Random Products Collage
        try {
          if (artists && artists.length > 0) {
            let allProducts = [];
            // Collect all products with images
            artists.forEach(artist => {
              if (artist.albums) {
                artist.albums.forEach(album => {
                  let img = null;
                  if (album.images && album.images.length > 0) img = album.images[0];
                  else if (album.cover) img = album.cover;
                  else if (album.image) img = album.image;

                  if (img) allProducts.push({ img: img, type: 'album' });
                });
              }
              if (artist.merch) {
                artist.merch.forEach(item => {
                  let img = null;
                  if (item.images && item.images.length > 0) img = item.images[0];
                  else if (item.image) img = item.image;

                  if (img) allProducts.push({ img: img, type: 'merch' });
                });
              }
            });

            const imageContainer = document.getElementById('promo-images-container');
            if (imageContainer) {
              const bg = imageContainer.querySelector('div[style*="radial-gradient"]');
              imageContainer.innerHTML = '';
              if (bg) imageContainer.appendChild(bg);

              let productsToShow = [];
              if (allProducts.length > 0) {
                productsToShow = shuffleArray(allProducts).slice(0, 3);
              } else {
                productsToShow = [
                  { img: 'assets/images/placeholder.png' },
                  { img: 'assets/images/placeholder.png' }
                ];
              }

              imageContainer.className = `promo-products-container promo-count-${productsToShow.length}`;

              productsToShow.forEach((prod, i) => {
                const img = document.createElement('img');
                img.src = prod.img;
                img.className = `promo-image-collage promo-item-${i} fade-in`;
                img.alt = 'Producto en oferta';
                imageContainer.appendChild(img);
              });
            }
          }
        } catch (e) {
          console.error('Promo Logic Error:', e);
        }
      }
    }

    document.addEventListener('DOMContentLoaded', loadAllData);
  </script>
</body>

</html>